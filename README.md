# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/AppState.ts — здесь собраны интерфейсы, описывающие состояние приложения, UI-элементов и работу с формами
- src/types/ProductApi.ts – здесь собраны интерфейсы, описывающие доменные объекты и взаимодействие с API
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```


## Описание интерфейса

Интерфейс можно условно разделить на 3 процесса:

1. Просмотр каталога товаров (MainScreen)
2. Просмотр карточки товара (CardPreviewScreen)
3. Оформление заказа (BasketScreen, OrderScreen, SuccessScreen)

Так как модальные окна в проекте однотипные, то их общая логика и структура вынесена в абстрактный класс ModalScreen. Все модальные окна наследуются от него и переопределяют методы для своих нужд.

---


## Данные и типы данных, используемые в приложении


В этом разделе описаны основные интерфейсы, используемые в приложении для работы с карточками товаров, оплатой заказа и контактной информацией.

---

### 1. Интерфейс карточки товара

Определяет структуру данных, которая представляет отдельную карточку товара.

```
export interface IProductCard {
  id: string;           // Уникальный идентификатор товара
  description: string;  // Описание товара
  image: string;        // Ссылка на изображение товара
  title: string;        // Название товара
  category: string;     // Категория, к которой относится товар
  price: number;        // Стоимость товара
};
```

---

### 2. Интерфейс для работы с коллекцией карточек

Определяет работу с коллекцией карточек. 

```
export interface IProductCatalog {
  items: IProductCard[];                           // Массив карточек товаров
};
```

---

### 3. Интерфейс данных оплаты заказа

Определяет набор полей, необходимых для оформления оплаты заказа. Содержит информацию о способе оплаты и адресе доставки.


```
export interface IPaymentDetails {
  method: string;   // Метод оплаты
  address: string;  // Адрес доставки товара
};
```


---

### 4. Интерфейс контактной информации

Содержит контактные данные пользователя, такие как email и телефон.

```
export interface IContactInfo {
  email: string;  // Email пользователя
  phone: string;  // Телефон пользователя
};
```

---

### 5. Интерфейс итоговых данных заказа

Определяет структуру данных, передаваемых на сервер при оформлении заказа. Включает контактную информацию, способы оплаты, идентификаторы товаров и общую стоимость заказа.

```
export interface IOrderSummary {
  email: string;    // Email покупателя
  phone: string;    // Телефон покупателя
  address: string;  // Адрес доставки
  payment: string;  // Способ оплаты
  id: string[];     // Список идентификаторов товаров, включенных в заказ
  total: number;    // Общая сумма заказа
};
```

---

### 6. Интерфейс результата заказа

Отражает ответ, получаемый от сервера после оформления заказа. Содержит итоговую стоимость.

```
export interface IOrderResponse {
  id: string;     // Уникальный идентификатор заказа, сформированный сервером
  total: number;  // Итоговая стоимость заказа
};
```

---

### 7. Интерфейс полных данных для оформления заказа

Представляет полный набор данных, необходимых для заполнения заказа. Используется для первичной подготовки данных перед отправкой на сервер.

```
export interface IFullOrderData {
  email: string;    // Email покупателя
  phone: string;    // Телефон покупателя
  address: string;  // Адрес доставки
  payment: string;  // Метод оплаты
};
```



---

# Архитектура классов

Приложение организовано в соответствии с паттерном MVP (Model-View-Presenter):

- View: отвечает за визуальное представление компонентов на странице.  
- Model: управляет данными, их хранением и изменением.  
- Presenter: обеспечивает взаимодействие между View и Model.

---

## Класс Api

Класс Api инкапсулирует взаимодействие с сервером, предоставляя методы для отправки и получения данных.

### Свойства
- baseUrl (только для чтения): строка – URL сервера.  
- options (защищённое): объект RequestInit – конфигурация для HTTP-запросов, содержащая параметры запроса (метод, тело, заголовки и т.д.).

### Методы
- handleResponse(response: Response)  
  Обрабатывает ответ, полученный от сервера.

- get(endpoint: string)  
  Выполняет GET-запрос по заданному URL-эндпоинту.

- post(endpoint: string, data: any)  
  Отправляет POST-запрос на сервер с переданными данными.

---


## Класс Component

Класс Component определяет базовую функциональность работы с элементами DOM, которая может быть переиспользована в наследующих компонентах.

### Методы
- setText()  
  Устанавливает текстовое наполнение для указанного элемента.

- setImage()  
  Заменяет изображение, а также задаёт альтернативный текст для изображения.


---


# Контроллеры


## Класс EventEmitter

Класс EventEmitter предназначен для управления событиями и их обработчиками в приложении.

### Методы
- on(event: string, listener: Function)  
  Регистрирует обработчик для заданного события.

- emit(event: string, data?: any)  
  Генерирует событие и передаёт ему данные.

- trigger(callback: Function)  
  Возвращает обёртку для функции, которая инициирует событие при вызове.

---



# Модели


## Класс ProductsAPI

Класс ProductsAPI используется для взаимодействия с сервером при работе с товарами. 

#### Методы
- getProductCards()  
  Выполняет GET-запрос, возвращая массив данных карточек товаров.

- totalOrder(order: IOrderSummary)  
  Отправляет POST-запрос с данными заказа на сервер.

---


## Класс ProductCardData 

Это модель для приёма и обработки информации о карточках товаров.

#### Свойства
- cards: массив карточек товаров.  

#### Методы
- cards (сеттер)  
  Сохраняет массив данных о карточках товаров.

- cards (геттер)  
  Возвращает текущий массив карточек товаров.

- getCard(id: string)  
  Ищет и возвращает карточку товара по заданному идентификатору.

---


## Класс BasketData

Класс BasketData управляет данными корзины. Он принимает массив карточек и обрабатывает события через EventEmitter.

#### Свойства
- cards: массив товаров, находящихся в корзине.

#### Методы
- cards (геттер)  
  Возвращает текущий массив товаров в корзине.

- total (геттер)  
  Вычисляет и возвращает общую стоимость товаров в корзине.

- addBasketCard()  
  Добавляет товар в корзину.

- deleteBasketCard()  
  Удаляет товар из корзины.

- getBasketСardCount()  
  Возвращает количество товаров в корзине.

- clearBasket()  
  Очищает корзину.

---


## Класс OrderData

Класс OrderData представляет модель для хранения данных заказа, полученных от пользователя.

#### Свойства
- order: объект, содержащий данные пользователя.  
- validationErrors: объект, содержащий ошибки, возникающие при неполном заполнении полей.

### Методы
- setOrder(): Сохраняет введённые пользователем данные в объект заказа.  
- updatePaymentMethod(): Обновляет данные способа оплаты.  
- validateOrder(): Проверяет заполненность необходимых полей и возвращает информацию об ошибках.

---



# Отображения

В данном разделе описана реализация визуальных компонентов приложения. Все классы отвечают за отрисовку, управление отображением элементов и генерацию событий, связанных с пользовательским интерфейсом.

---


## Класс ProductCard

Класс ProductCard реализует визуальное представление отдельной карточки товара. Он заполняет карточку информацией (название, изображение, описание, категория, цена) и настраивает обработчики для интерактивных элементов, генерируя события через EventEmitter.

### Свойства
- events – экземпляр EventEmitter для генерации и обработки событий.
- id – строка с уникальным идентификатором карточки.
- title – HTML-элемент, отображающий название товара.
- category – HTML-элемент, отображающий название категорию.
- image (необязательно) – HTMLImageElement для отображения изображения.
- price – HTML-элемент, предназначенный для вывода цены.

### Методы
- Геттер id – возвращает уникальный идентификатор карточки.
- Сеттер id – устанавливает идентификатор для карточки.
- Сеттер title – обновляет заголовок карточки.
- Сеттер price – устанавливает цену.
- Сеттер category – задаёт категорию товара.
- Сеттер image – обновляет изображение карточки.

---


## Класс ProductCardsContainer

Класс CardsContainer отвечает за управление коллекцией шаблонов карточек и их выводом на странице.

### Свойства
- catalog – массив DOM-элементов, представляющих шаблоны карточек.
- container – корневой элемент, в котором происходит рендеринг карточек.

### Методы
- Сеттер для массива шаблонов карточек – обновляет набор шаблонов.
- render() – собирает и возвращает финальный набор карточек для отображения.

---


## Класс Modal

Класс Modal отвечает за работу с модальными окнами. Он поддерживает несколько шаблонов модальных окон и использует EventEmitter для управления событиями.

### Свойства
- closeModalButton – HTMLButtonElement, отвечающий за закрытие модального окна.
- content – HTML-элемент, в который загружается содержимое модального окна.

### Методы
- open() – открывает модальное окно.
- close() – закрывает модальное окно.
- closeModalEscape() – обеспечивает закрытие окна при нажатии клавиши Escape.
- render() – осуществляет отрисовку модального окна.

---


## Класс ModalProductCardPreview

Класс ModalProductCardPreview предназначен для предварительного просмотра карточки товара в модальном окне. Он расширяет функциональность класса ProductCard, добавляя обработку описания товара и кнопку «Купить».

### Свойства
- description – HTML-элемент, отображающий подробное описание товара.
- purchaseButton – HTMLButtonElement, предназначенный для инициирования покупки в модальном окне.

### Методы
- Сеттер для description – добавляет информацию об описании товара.

---


## Класс Form

Класс Form предназначен для валидации данных формы и отображения сообщений об ошибках. 

### Свойства
- submit – HTMLButtonElement, отвечающий за отправку формы и переход к следующему этапу (открытию другого модального окна).
- errors – HTML-элемент, в котором выводятся сообщения об ошибках при неполном или неверном заполнении полей.

### Методы
- Сеттер errors – устанавливает и выводит текст ошибки, возникающей при неправильном или неполном вводе данных.

---


## Класс PaymentModal

Класс PaymentModal отвечает за визуализацию модального окна, в котором пользователь выбирает способ оплаты и вводит адрес доставки. Он обеспечивает корректное отображение полей, связанных с оплатой заказа, а также контактной информации пользователя.

### Свойства
- paymentMethod: HTMLButtonElement[] – массив кнопок, каждая из которых представляет вариант способа оплаты.
- paymentMethodCard: HTMLButtonElement – кнопка для выбора оплаты банковской картой.
- paymentMethodCash: HTMLButtonElement – кнопка для выбора оплаты наличными.

### Методы
- valid – управляет состоянием (disabled) кнопок.
- address – устанавливает значение поля для ввода или отображения адреса пользователя.

---


## Класс ContactInfo

Класс ContactInfo отвечает за вывод модального окна, содержащего контактную информацию пользователя (email и телефон).

### Методы
- valid – сеттер, который управляет функциональностью кнопок (disabled).
- phone – обновляет значение поля для ввода телефона.
- email – задает значение для поля ввода email.

---


## Класс OrderResponse

Класс OrderResponse представляет собой финальное окно, подтверждающее успешную отправку данных заказа на сервер. Он наследуется от класса Component и отображает сумму заказа.

### Свойства
- total: HTMLElement – элемент для отображения итоговой суммы заказа.

### Методы
- totalPrice – cеттер, предназначенный для обновления и отображения суммы заказа.
